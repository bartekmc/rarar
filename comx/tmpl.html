<!DOCTYPE html>
<html>
<head>
  <title>Basic fotorama</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">

  <!-- jQuery -->
  <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>

  <!-- jQuery Mobile 
  <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
  -->

  <!-- Hammer.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.6/hammer.js"></script>
  <script src="https://cdn.jsdelivr.net/jquery.hammerjs/2.0.0/jquery.hammer.js"></script>

  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">

  <!-- Latest compiled and minified JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

  <!-- Fotorama -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.js"></script>

  <!-- bootstrap-autohidingnavbar -->
  <script src="https://cdn.jsdelivr.net/bootstrap.autohidingnavbar/1.0.4/jquery.bootstrap-autohidingnavbar.min.js"></script>

  <!-- Just donâ€™t want to repeat this prefix in every img[src] -->
  <!-- <base href="http://s.fotorama.io/okonechnikov/"> -->
<style>
.fotorama__img {
    top: 0 !important;
    width: 100% !important;
    left: 0px !important;
    margin-top: 0 !important;
}

#img_page{
    width: 100%;
}

% if hobj.dirs is not None:
body{
    padding-top:70px;
}
% end

.fotorama__wrap {
    margin: 0 auto;
}
</style>
</head>


<body>
<script>
$(document).ready(function() {


$("#img_page").load(function(){
        console.log('Image is loaded!\n');
    })
    .error(function(){
        console.log('Image is not loaded!\n');
        // in this case you must reload image with jQuery
        setTimeout(function(ss){
            var imgSrc = $(ss).attr('src');
            $(ss).attr('src',imgSrc);
        }, 1000, this);
});


// 1. Initialize fotorama manually.
//    var $fotoramaDiv = $('.fotorama').fotorama();

    // 2. Get the API object.
//    var fotorama = $fotoramaDiv.data('fotorama');
//    fotorama.show({{hobj.last_page}});


//var myElement = document.getElementById('img_page');

//var mc = new Hammer.Manager(myElement);

// create a pinch and rotate recognizer
// these require 2 pointers
//var pinch = new $('#img_page').hammer.Pinch();
//var rotate = new Hammer.Rotate();

// we want to detect both the same time
//pinch.recognizeWith(rotate);

// add to the Manager
//mc.add([pinch, rotate]);


//mc.on("pinch rotate", function(ev) {
 //   myElement.textContent += ev.type +" ";
//});

//   $('.fotorama').on('fotorama:showend', function (e, fotorama) {

%if hobj.pages is not None:

 //           if (fotorama.size == fotorama.activeIndex + 1)
  //          {
   //         $.ajax({
    //                url: "{{hobj.saveX_link}}/999",
     //           }).done(function() {
      //                              });
//
 //           }
  //          else
   //         {
    //        $.ajax({
     //               url: "{{hobj.saveX_link}}/"+fotorama.activeIndex,
      //          }).done(function() {
       //                             });
       // 
        //    }

% end


//        console.log(e.type, fotorama.activeIndex);
        
 //       $(".navbar-fixed-top").autoHidingNavbar('hide');
  //      window.scrollTo(0,0);
   // });


    $(".navbar-fixed-top").autoHidingNavbar({
        disableAutohide:false,
    });


    $("#img_page" ).hammer({touchAction : 'auto'}).bind("tap", function(event) {
 //       console.log(event.pointers);
  //      console.log(event.center);
//

        if ( $(".navbar-fixed-top").hasClass("navbar-hidden") ) 
        {
            $(".navbar-fixed-top").autoHidingNavbar('show');
        }
        else
        {
            $(".navbar-fixed-top").autoHidingNavbar('hide');
        }
    });
//    $("#img_page" ).data("hammer").get('pinch').set({ enable: false });

 //   $("#img_page" ).hammer({prevent_default:true}).bind("pinchin", function() {
//console.log("pinchin");
//});
 //   $("#img_page" ).hammer({prevent_default:true}).bind("pinchout", function() {
//console.log("pinchout");
//});
 });

</script>

<nav class="navbar-fixed-top navbar-inverse">
 <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">ComixHost</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#about">Last</a></li>
            <li><a href="#contact">Contact</a></li>
            <li><a href="{{hobj.back_link}}">Back</a></li>
          </ul>
        </div><!--/.nav-collapse -->
</nav>

<div class="container">
<div class="row">
%if hobj.dirs is not None:
<ul class="list-group">
% for d in hobj.dirs:
  <li class="list-group-item">
    <span class="glyphicon glyphicon-folder-open"></span> 
<a href="{{d.link}}">{{d.name}}</a>

</li>
% end
</ul>
% end
</div>
<div class="row">
%if hobj.comics is not None:
<ul class="list-group">
% for c in hobj.comics:
  <li class="list-group-item">
    % if not c.read_icon and not c.finished_icon:
        <span class="glyphicon glyphicon-file"></span> 
    % end
    % if c.read_icon:
        <span class="glyphicon glyphicon-eye-open" aria-hidden="true"></span>
    % end

    % if c.finished_icon:
        <span class="glyphicon glyphicon-check" aria-hidden="true"></span>
    % end

    <a href="{{c.link}}">{{c.name}}</a>

% if c.directLink is not None:

    <a href="{{c.directLink}}" class="btn btn-xs btn-success pull-right" role="button">
            <span class="glyphicon glyphicon-save" aria-hidden="true"></span>
    </a>
% end

</li>
% end
</ul>
% end

</div>

<div class="row">
% if hobj.pages is not None:
<img id="img_page" src="{{hobj.image_src}}"></img>
<a href="{{hobj.prev_page}}">PREV</a>
<a href="{{hobj.next_page}}">NNNEEEXXXTTT</a>
% end
</div>
</div>


</body>
</html>
